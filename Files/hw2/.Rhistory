geom_line(data = dftest[191:246,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[214,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[191:246,], aes(x = dates, y = cbreserves), colour = "red", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[50:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[50:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[191:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[191:246,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[191:246,], aes(x = dates, y = cbreserves), colour = "red", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[257,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[246:273,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[257,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[246:273,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[257,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[246:273,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[332,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[320:365,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = interestrate, colour="interestrate")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="interestrate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank Of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = interestrate, colour="interestrate")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="interestrate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = interestrate, colour="interestrate")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="interestrate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = interestrate, colour="interestrate")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="interestrate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
cor.test(exchangerate,interestrate)
ggplot(dftest, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
cor.test(exchangerate,cbreserves)
ggplot(dftest, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
cor.test(cbreserves,interestrate)
ggplot(dftest, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + Xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(dataset[1,] == "2013")], aes(xintercept = mean(exchangerate)),col='red',size=1, alpha = 0.5)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(dataset[1,] == "2013")], aes(xintercept = mean(exchangerate)),col='red',size=1, alpha = 0.5)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
setwd('/Users/metedibi/Desktop/Dersler/IE360/Supplementary Course Material/data')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
exchangerate<-as.numeric(rates$rate)
cbreserves<-as.numeric(reserves$reserveamount)
interestrate<-as.numeric(interestdata$interest.rates)
dates<-seq (as.Date("04-01-2013",  format = "%d-%m-%Y"), length.out = 365, by = "week")
years<-c(rep("2013", 52), rep("2014", 52),rep("2015", 52),rep("2016", 53),rep("2017", 52),rep("2018", 52),rep("2019", 52))
dataset<-tibble(years, dates, exchangerate, interestrate, cbreserves)
dataset
ggplot(dftest,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(dataset[1,] == "2013")], aes(xintercept = mean(exchangerate)),col='red',size=1, alpha = 0.5)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(dataset[1,] == "2013"),], aes(xintercept = mean(exchangerate)),col='red',size=1, alpha = 0.5)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(exchangerate)),col='red',size=1, alpha = 0.5)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.5)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='black',size=1, alpha = 0.3, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2014"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2015"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2016"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2017"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2018"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2019"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='red',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2014"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2015"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2016"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2017"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2018"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2019"), ], aes(xintercept = mean(interestrate)),col='lightgray',size=1, alpha = 0.3, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2014"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2015"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2016"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2017"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2018"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2) +  geom_vline(data=dataset[which(years == "2019"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.3, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[which(years == "2013"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2014"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2015"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2016"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2017"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2018"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2) +  geom_vline(data=dataset[which(years == "2019"), ], aes(xintercept = mean(interestrate)),col='gray',size=1, alpha = 0.4, linetype = 2)
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years = "2019", ], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[, years = "2019"], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years = "2019"], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years = "2019", cbreserves], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years = "2019", ], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years == "2019", ], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years == "2019", ], aes(xintercept = mean(cbreserves)), col = "red") + geom_vline(data=dataset[years == "2018", ], aes(xintercept = mean(cbreserves)), col = "red")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)") + geom_vline(data=dataset[years == "2019", ], aes(xintercept = mean(cbreserves)), col = "red") + geom_vline(data=dataset[years == "2018", ], aes(xintercept = mean(cbreserves)), col = "green")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + + geom_vline(data=dataset[years == "2019", ], aes(xintercept = mean(interestrate)), col = "red") + geom_vline(data=dataset[years == "2018", ], aes(xintercept = mean(interestrate)), col = "green")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts") + geom_vline(data=dataset[years == "2019", ], aes(xintercept = mean(interestrate)), col = "red") + geom_vline(data=dataset[years == "2018", ], aes(xintercept = mean(interestrate)), col = "green")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[20:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[20:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[20:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = exchangerate), color = "black", size = 3, alpha = 0.5)+
geom_line(data = dftest[20:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = interestrate), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[20:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = cbreserves), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = cbreserves), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[20:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = exchangerate), color = "black", size = 3, alpha = 0.5)+
geom_line(data = dftest[35:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = interestrate), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[35:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = cbreserves), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = cbreserves), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[35:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = exchangerate), color = "black", size = 3, alpha = 0.5)+
geom_line(data = dftest[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = interestrate), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest50:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = exchangerate), color = "black", size = 3, alpha = 0.5)+
geom_line(data = dftest[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = interestrate), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = interestrate), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[50:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = cbreserves), color = "black", size = 3) + geom_point(data = dftest[51,], aes(x = dates, y = cbreserves), color = "black", size = 3, alpha = 0.5) +
geom_line(data = dftest[50:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[196:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[196:246,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[213,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[196:246,], aes(x = dates, y = cbreserves), colour = "red", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = interestrate, colour="interestrate")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="exchangerate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="interestrate")) + geom_line(aes(y = cbreserves / 5000, colour="cbreserves")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
cor.test(exchangerate,cbreserves)
ggplot(dftest, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
cor.test(exchangerate,cbreserves)
ggplot(dftest, aes(exchangerate, cbreserves)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
cor.test(exchangerate,cbreserves)
ggplot(dftest, aes(exchangerate, cbreserves)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom")
cor.test(cbreserves,interestrate)
ggplot(dftest, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top")
cor.test(cbreserves,interestrate)
ggplot(dftest, aes(cbreserves, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom")
ggplot(dftest,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dftest,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[84:190,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[84:190,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[84:190,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[57,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[50:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))  +
geom_line(data = dftest[50:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[50:83,], aes(x = dates, y = interestrate), colour = "red", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))  +
geom_line(data = dftest[50:83,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[196:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[196:246,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[196:246,], aes(x = dates, y = cbreserves), colour = "red", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[246:273,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[246:273,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[246:273,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = exchangerate), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = interestrate), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + geom_point(data = dftest[297,], aes(x = dates, y = cbreserves), color = "black", size = 3) +
geom_line(data = dftest[273:320,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[273:320,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[273:320,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
fit <- lm(exchangerate ~  interestrate - cbreserves , data=Data_for_hw2)
fit <- lm(exchangerate ~  interestrate - cbreserves , data=dataset)
summary(fit)
fit <- lm(interestrate ~  exchangerate - cbreserves, data=dataset)
summary(fit)
fit <- lm(interestrate ~  exchangerate - cbreserves, data=dataset)
summary(fit)
fit <- lm(cbreserves ~  -exchangerate - interestrate, data=dataset)
summary(fit)
fit <- lm(cbreserves ~  exchangerate + interestrate, data=dataset)
summary(fit)
fit <- lm(interestrate ~  exchangerate + cbreserves, data=dataset)
summary(fit)
fit <- lm(exchangerate ~  interestrate + cbreserves, data=dataset)
summary(fit)
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate")) + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate")) + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts")) + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
ggplot(dftest,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dftest,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[320:365,], aes(x = dates, y = interestrate), colour = "red", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dftest,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dftest[320:365,], aes(x = dates, y = cbreserves), colour = "red", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "yellow") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate")) + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts")) + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts")) + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey")) + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
knitr::opts_chunk$set(echo = TRUE)
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of Central Bank of Turkey")
ggplot(dftest,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of Central Bank of Turkey vs Interest Rate on TRY Accounts")
#pik noktalara v_line ile çizgi çek
corr <- cor(dataset)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
setwd('/Users/metedibi/Desktop/Dersler/IE360/Supplementary Course Material/data')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
exchangerate<-as.numeric(rates$rate)
cbreserves<-as.numeric(reserves$reserveamount)
interestrate<-as.numeric(interestdata$interest.rates)
dates<-seq (as.Date("04-01-2013",  format = "%d-%m-%Y"), length.out = 365, by = "week")
years<-c(rep("2013", 52), rep("2014", 52),rep("2015", 52),rep("2016", 53),rep("2017", 52),rep("2018", 52),rep("2019", 52))
dataset<-tibble(years, dates, exchangerate, interestrate, cbreserves)
dataset
corr <- cor(dataset[,3:5])
ggcorrplot(corr, lab = TRUE)
View(dftest)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
setwd('/Users/metedibi/Desktop/Dersler/IE360/Supplementary Course Material/data')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
exchangerate<-as.numeric(rates$rate)
cbreserves<-as.numeric(reserves$reserveamount)
interestrate<-as.numeric(interestdata$interest.rates)
dates<-seq (as.Date("04-01-2013",  format = "%d-%m-%Y"), length.out = 365, by = "week")
years<-c(rep("2013", 52), rep("2014", 52),rep("2015", 52),rep("2016", 53),rep("2017", 52),rep("2018", 52),rep("2019", 52))
dataset<-tibble(years, dates, exchangerate, interestrate, cbreserves)
dataset
ggplot(dataset,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dataset,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))  +
geom_line(data = dataset[50:83,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = cbreserves), colour = "blue", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of CBRT")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of CBRT vs Interest Rate on TRY Accounts")
cor.test(exchangerate,interestrate)
ggplot(dataset, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top") +
cor.test(exchangerate,interestrate)
ggplot(dataset, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top") + xlab("USD-TRY Rate") + ylab("Interest Rate on TRY Accounts")
cor.test(exchangerate,cbreserves)
ggplot(dataset, aes(exchangerate, cbreserves)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD-TRY Rate") + ylab("USD Reserves of CBRT")
cor.test(cbreserves,interestrate)
ggplot(dataset, aes(cbreserves, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD Reserves of CBRT") + ylab("Interest Rate on TRY Accounts")
setwd("~/Desktop/Dersler/IE360/Supplementary Course Material/data")
setwd("~/Documents/GitHub/fall20-metedibi/Files/hw2")
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
setwd('/Users/metedibi/Documents/GitHub/fall20-metedibi/Files/hw2')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
setwd('/Users/metedibi/Documents/GitHub/fall20-metedibi/Files/hw2')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
exchangerate<-as.numeric(rates$rate)
cbreserves<-as.numeric(reserves$reserveamount)
interestrate<-as.numeric(interestdata$interest.rates)
dates<-seq (as.Date("04-01-2013",  format = "%d-%m-%Y"), length.out = 365, by = "week")
years<-c(rep("2013", 52), rep("2014", 52),rep("2015", 52),rep("2016", 53),rep("2017", 52),rep("2018", 52),rep("2019", 52))
dataset<-tibble(years, dates, exchangerate, interestrate, cbreserves)
dataset
ggplot(dataset,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dataset,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))  +
geom_line(data = dataset[50:83,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = cbreserves), colour = "blue", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of CBRT")
ggplot(dataset,aes(x = dates.week)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of CBRT vs Interest Rate on TRY Accounts")
cor.test(exchangerate,interestrate)
ggplot(dataset, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top") + xlab("USD-TRY Rate") + ylab("Interest Rate on TRY Accounts")
cor.test(exchangerate,cbreserves)
ggplot(dataset, aes(exchangerate, cbreserves)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD-TRY Rate") + ylab("USD Reserves of CBRT")
cor.test(cbreserves,interestrate)
ggplot(dataset, aes(cbreserves, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD Reserves of CBRT") + ylab("Interest Rate on TRY Accounts")
corr <- cor(dataset[,3:5])
ggcorrplot(corr, lab = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(GGally)
library(RColorBrewer)
library(ggjoy)
library(wesanderson)
library(ggpubr)
setwd('/Users/metedibi/Documents/GitHub/fall20-metedibi/Files/hw2')
rates<-read.csv(file = "rates.csv", header = TRUE)
reserves<-read.csv(file = "cbreserve.csv", header = TRUE)
interestdata<-read.csv(file = "interest.csv", header = TRUE)
exchangerate<-as.numeric(rates$rate)
cbreserves<-as.numeric(reserves$reserveamount)
interestrate<-as.numeric(interestdata$interest.rates)
dates<-seq (as.Date("04-01-2013",  format = "%d-%m-%Y"), length.out = 365, by = "week")
years<-c(rep("2013", 52), rep("2014", 52),rep("2015", 52),rep("2016", 53),rep("2017", 52),rep("2018", 52),rep("2019", 52))
dataset<-tibble(years, dates, exchangerate, interestrate, cbreserves)
dataset
ggplot(dataset,aes(x = exchangerate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=3, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) +  ylab("Years") + xlab("USD-TRY Rate")
ggplot(dataset,aes(x = interestrate, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = cbreserves, y = years, fill = years)) + geom_joy(aes(alpha = 1), scale=2, rel_min_height=0.01) + theme_joy() + scale_fill_manual(values = c(wes_palette("Rushmore1", n= 4), wes_palette("Royal1", n= 3))) + ylab("Years") + xlab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD Reserves of CBRT (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = exchangerate), colour = "red", size = 1) +
xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[50:83,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))  +
geom_line(data = dataset[50:83,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = interestrate), colour = "green", size = 1) + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[84:190,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[196:246,], aes(x = dates, y = cbreserves), colour = "blue", size = 1)  + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[246:273,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[273:320,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(dates, exchangerate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = exchangerate), colour = "red", size = 1) + xlab("Time") + ylab("USD-TRY Rate")
ggplot(dataset,aes(dates, interestrate)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = interestrate), colour = "green", size = 1)  + xlab("Time") + ylab("Interest Rate on TRY Accounts")
ggplot(dataset,aes(dates, cbreserves)) +  geom_line() + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +
geom_line(data = dataset[320:365,], aes(x = dates, y = cbreserves), colour = "blue", size = 1) + xlab("Time") + ylab("USD Reserves of Central Bank of Turkey (in Million Dollars)")
ggplot(dataset,aes(x = dates)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD-TRY Rate vs Interest Rate on TRY Accounts")
ggplot(dataset,aes(x = dates)) +  geom_line(aes(y = exchangerate * 3.8, colour="USD-TRY Rate"), col = "red") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("USD-TRY Rate vs USD Reserves of CBRT")
ggplot(dataset,aes(x = dates)) +  geom_line(aes(y = interestrate, colour="Interest Rate on TRY Accounts"), col ="green") + geom_line(aes(y = cbreserves / 5000, colour="USD Reserves of Central Bank of Turkey"), col ="blue") + scale_x_date(date_labels = "%b-%Y", breaks = "6 months")  +  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1)) +  xlab("Time") + ylab("USD Reserves of CBRT vs Interest Rate on TRY Accounts")
cor.test(exchangerate,interestrate)
ggplot(dataset, aes(exchangerate, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "top") + xlab("USD-TRY Rate") + ylab("Interest Rate on TRY Accounts")
cor.test(exchangerate,cbreserves)
ggplot(dataset, aes(exchangerate, cbreserves)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD-TRY Rate") + ylab("USD Reserves of CBRT")
cor.test(cbreserves,interestrate)
ggplot(dataset, aes(cbreserves, interestrate)) + geom_point(alpha=0.75) + geom_smooth(method = "lm") + stat_cor(label.x.npc = "left", label.y.npc = "bottom") + xlab("USD Reserves of CBRT") + ylab("Interest Rate on TRY Accounts")
corr <- cor(dataset[,3:5])
ggcorrplot(corr, lab = TRUE)
